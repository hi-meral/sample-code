
// jquery.ui.widget.js
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(b,c){var d=0,e=Array.prototype.slice,a=b.cleanData;b.cleanData=function(g){for(var h=0,j;(j=g[h])!=null;h++){try{b(j).triggerHandler("remove")}catch(f){}}a(g)};b.widget=function(i,f,g){var h,k,m,j,n={},l=i.split(".")[0];i=i.split(".")[1];h=l+"-"+i;if(!g){g=f;f=b.Widget}b.expr[":"][h.toLowerCase()]=function(o){return !!b.data(o,h)};b[l]=b[l]||{};k=b[l][i];m=b[l][i]=function(o,p){if(!this._createWidget){return new m(o,p)}if(arguments.length){this._createWidget(o,p)}};b.extend(m,k,{version:g.version,_proto:b.extend({},g),_childConstructors:[]});j=new f();j.options=b.widget.extend({},j.options);b.each(g,function(o,p){if(!b.isFunction(p)){n[o]=p;return}n[o]=(function(){var q=function(){return f.prototype[o].apply(this,arguments)},r=function(s){return f.prototype[o].apply(this,s)};return function(){var u=this._super,s=this._superApply,t;this._super=q;this._superApply=r;t=p.apply(this,arguments);this._super=u;this._superApply=s;return t}})()});m.prototype=b.widget.extend(j,{widgetEventPrefix:k?j.widgetEventPrefix:i},n,{constructor:m,namespace:l,widgetName:i,widgetFullName:h});if(k){b.each(k._childConstructors,function(p,q){var o=q.prototype;b.widget(o.namespace+"."+o.widgetName,m,q._proto)});delete k._childConstructors}else{f._childConstructors.push(m)}b.widget.bridge(i,m)};b.widget.extend=function(k){var h=e.call(arguments,1),f=0,j=h.length,i,g;for(;f<j;f++){for(i in h[f]){g=h[f][i];if(h[f].hasOwnProperty(i)&&g!==c){if(b.isPlainObject(g)){k[i]=b.isPlainObject(k[i])?b.widget.extend({},k[i],g):b.widget.extend({},g)}else{k[i]=g}}}}return k};b.widget.bridge=function(g,f){var h=f.prototype.widgetFullName||g;b.fn[g]=function(k){var l=typeof k==="string",j=e.call(arguments,1),i=this;k=!l&&j.length?b.widget.extend.apply(null,[k].concat(j)):k;if(l){this.each(function(){var m,n=b.data(this,h);if(!n){return b.error("cannot call methods on "+g+" prior to initialization; attempted to call method '"+k+"'")}if(!b.isFunction(n[k])||k.charAt(0)==="_"){return b.error("no such method '"+k+"' for "+g+" widget instance")}m=n[k].apply(n,j);if(m!==n&&m!==c){i=m&&m.jquery?i.pushStack(m.get()):m;return false}})}else{this.each(function(){var m=b.data(this,h);if(m){m.option(k||{})._init()}else{b.data(this,h,new f(k,this))}})}return i}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(f,g){g=b(g||this.defaultElement||this)[0];this.element=b(g);this.uuid=d++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=b.widget.extend({},this.options,this._getCreateOptions(),f);this.bindings=b();this.hoverable=b();this.focusable=b();if(g!==this){b.data(g,this.widgetFullName,this);this._on(true,this.element,{remove:function(h){if(h.target===g){this.destroy()}}});this.document=b(g.style?g.ownerDocument:g.document||g);this.window=b(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(j,g){var f=j,h,k,l;if(arguments.length===0){return b.widget.extend({},this.options)}if(typeof j==="string"){f={};h=j.split(".");j=h.shift();if(h.length){k=f[j]=b.widget.extend({},this.options[j]);for(l=0;l<h.length-1;l++){k[h[l]]=k[h[l]]||{};k=k[h[l]]}j=h.pop();if(g===c){return k[j]===c?null:k[j]}k[j]=g}else{if(g===c){return this.options[j]===c?null:this.options[j]}f[j]=g}}this._setOptions(f);return this},_setOptions:function(g){var f;for(f in g){this._setOption(f,g[f])}return this},_setOption:function(g,f){this.options[g]=f;if(g==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!f).attr("aria-disabled",f);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(h,f,i){var g,j=this;if(typeof h!=="boolean"){i=f;f=h;h=false}if(!i){i=f;f=this.element;g=this.widget()}else{f=g=b(f);this.bindings=this.bindings.add(f)}b.each(i,function(k,o){function m(){if(!h&&(j.options.disabled===true||b(this).hasClass("ui-state-disabled"))){return}return(typeof o==="string"?j[o]:o).apply(j,arguments)}if(typeof o!=="string"){m.guid=o.guid=o.guid||m.guid||b.guid++}var l=k.match(/^(\w+)\s*(.*)$/),p=l[1]+j.eventNamespace,n=l[2];if(n){g.delegate(n,p,m)}else{f.bind(p,m)}})},_off:function(g,f){f=(f||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;g.unbind(f).undelegate(f)},_delay:function(g,f){function i(){return(typeof g==="string"?h[g]:g).apply(h,arguments)}var h=this;return setTimeout(i,f||0)},_hoverable:function(f){this.hoverable=this.hoverable.add(f);this._on(f,{mouseenter:function(g){b(g.currentTarget).addClass("ui-state-hover")},mouseleave:function(g){b(g.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(f){this.focusable=this.focusable.add(f);this._on(f,{focusin:function(g){b(g.currentTarget).addClass("ui-state-focus")},focusout:function(g){b(g.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(j,f,g){var k,h,i=this.options[j];g=g||{};f=b.Event(f);f.type=(j===this.widgetEventPrefix?j:this.widgetEventPrefix+j).toLowerCase();f.target=this.element[0];h=f.originalEvent;if(h){for(k in h){if(!(k in f)){f[k]=h[k]}}}this.element.trigger(f,g);return !(b.isFunction(i)&&i.apply(this.element[0],[f].concat(g))===false||f.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(f,g){b.Widget.prototype["_"+f]=function(h,k,l){if(typeof k==="string"){k={effect:k}}var j,i=!k?f:k===true||typeof k==="number"?g:k.effect||g;k=k||{};if(typeof k==="number"){k={duration:k}}j=!b.isEmptyObject(k);k.complete=l;if(k.delay){h.delay(k.delay)}if(j&&b.effects&&b.effects.effect[i]){h[f](k)}else{if(i!==f&&h[i]){h[i](k.duration,k.easing,l)}else{h.queue(function(m){b(this)[f]();if(l){l.call(h[0])}m()})}}}})}));


// jquery.iframe-transport.js
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery)}}(function(a){var b=0;a.ajaxTransport("iframe",function(e){if(e.async){var f,d,c;return{send:function(h,g){f=a('<form style="display:none;"></form>');f.attr("accept-charset",e.formAcceptCharset);c=/\?/.test(e.url)?"&":"?";if(e.type==="DELETE"){e.url=e.url+c+"_method=DELETE";e.type="POST"}else{if(e.type==="PUT"){e.url=e.url+c+"_method=PUT";e.type="POST"}else{if(e.type==="PATCH"){e.url=e.url+c+"_method=PATCH";e.type="POST"}}}b+=1;d=a('<iframe src="javascript:false;" name="iframe-transport-'+b+'"></iframe>').bind("load",function(){var j,i=a.isArray(e.paramName)?e.paramName:[e.paramName];d.unbind("load").bind("load",function(){var k;try{k=d.contents();if(!k.length||!k[0].firstChild){throw new Error()}}catch(l){k=undefined}g(200,"success",{iframe:k});a('<iframe src="javascript:false;"></iframe>').appendTo(f);window.setTimeout(function(){f.remove()},0)});f.prop("target",d.prop("name")).prop("action",e.url).prop("method",e.type);if(e.formData){a.each(e.formData,function(l,k){a('<input type="hidden"/>').prop("name",k.name).val(k.value).appendTo(f)})}if(e.fileInput&&e.fileInput.length&&e.type==="POST"){j=e.fileInput.clone();e.fileInput.after(function(k){return j[k]});if(e.paramName){e.fileInput.each(function(k){a(this).prop("name",i[k]||e.paramName)})}f.append(e.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")}f.submit();if(j&&j.length){e.fileInput.each(function(k,m){var l=a(j[k]);a(m).prop("name",l.prop("name"));l.replaceWith(m)})}});f.append(d).appendTo(document.body)},abort:function(){if(d){d.unbind("load").prop("src","javascript".concat(":false;"))}if(f){f.remove()}}}}});a.ajaxSetup({converters:{"iframe text":function(c){return c&&a(c[0].body).text()},"iframe json":function(c){return c&&a.parseJSON(a(c[0].body).text())},"iframe html":function(c){return c&&a(c[0].body).html()},"iframe xml":function(d){var c=d&&d[0];return c&&a.isXMLDoc(c)?c:a.parseXML((c.XMLDocument&&c.XMLDocument.xml)||a(c.body).html())},"iframe script":function(c){return c&&a.globalEval(a(c[0].body).text())}}})}));

// jquery.fileupload.js
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget"],a)}else{a(window.jQuery)}}(function(a){a.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||a('<input type="file">').prop("disabled"));a.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);a.support.xhrFormDataFileUpload=!!window.FormData;a.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.widget("blueimp.fileupload",{options:{dropZone:a(document),pasteZone:a(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(b,c){b=this.messages[b]||b.toString();if(c){a.each(c,function(e,d){b=b.replace("{"+e+"}",d)})}return b},formData:function(b){return b.serializeArray()},add:function(b,c){if(c.autoUpload||(c.autoUpload!==false&&a(this).fileupload("option","autoUpload"))){c.process().done(function(){c.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:a.support.blobSlice&&function(){var b=this.slice||this.webkitSlice||this.mozSlice;return b.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(b,e,d){var c=b-this.timestamp;if(!this.bitrate||!d||c>d){this.bitrate=(e-this.loaded)*(1000/c)*8;this.loaded=e;this.timestamp=b}return this.bitrate}},_isXHRUpload:function(b){return !b.forceIframeTransport&&((!b.multipart&&a.support.xhrFileUpload)||a.support.xhrFormDataFileUpload)},_getFormData:function(c){var b;if(typeof c.formData==="function"){return c.formData(c.form)}if(a.isArray(c.formData)){return c.formData}if(a.type(c.formData)==="object"){b=[];a.each(c.formData,function(e,d){b.push({name:e,value:d})});return b}return[]},_getTotal:function(b){var c=0;a.each(b,function(e,d){c+=d.size||1});return c},_initProgressObject:function(c){var b={loaded:0,total:0,bitrate:0};if(c._progress){a.extend(c._progress,b)}else{c._progress=b}},_initResponseObject:function(c){var b;if(c._response){for(b in c._response){if(c._response.hasOwnProperty(b)){delete c._response[b]}}}else{c._response={}}},_onProgress:function(c,f){if(c.lengthComputable){var b=((Date.now)?Date.now():(new Date()).getTime()),d;if(f._time&&f.progressInterval&&(b-f._time<f.progressInterval)&&c.loaded!==c.total){return}f._time=b;d=Math.floor(c.loaded/c.total*(f.chunkSize||f._progress.total))+(f.uploadedBytes||0);this._progress.loaded+=(d-f._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(b,this._progress.loaded,f.bitrateInterval);f._progress.loaded=f.loaded=d;f._progress.bitrate=f.bitrate=f._bitrateTimer.getBitrate(b,d,f.bitrateInterval);this._trigger("progress",c,f);this._trigger("progressall",c,this._progress)}},_initProgressListener:function(d){var b=this,c=d.xhr?d.xhr():a.ajaxSettings.xhr();if(c.upload){a(c.upload).bind("progress",function(f){var g=f.originalEvent;f.lengthComputable=g.lengthComputable;f.loaded=g.loaded;f.total=g.total;b._onProgress(f,d)});d.xhr=function(){return c}}},_isInstanceOf:function(b,c){return Object.prototype.toString.call(c)==="[object "+b+"]"},_initXHRData:function(e){var f=this,g,c=e.files[0],d=e.multipart||!a.support.xhrFileUpload,b=e.paramName[0];e.headers=e.headers||{};if(e.contentRange){e.headers["Content-Range"]=e.contentRange}if(!d||e.blob||!this._isInstanceOf("File",c)){e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(c.name)+'"'}if(!d){e.contentType=c.type;e.data=e.blob||c}else{if(a.support.xhrFormDataFileUpload){if(e.postMessage){g=this._getFormData(e);if(e.blob){g.push({name:b,value:e.blob})}else{a.each(e.files,function(i,h){g.push({name:e.paramName[i]||b,value:h})})}}else{if(f._isInstanceOf("FormData",e.formData)){g=e.formData}else{g=new FormData();a.each(this._getFormData(e),function(i,h){g.append(h.name,h.value)})}if(e.blob){g.append(b,e.blob,c.name)}else{a.each(e.files,function(i,h){if(f._isInstanceOf("File",h)||f._isInstanceOf("Blob",h)){g.append(e.paramName[i]||b,h,h.name)}})}}e.data=g}}e.blob=null},_initIframeSettings:function(c){var b=a("<a></a>").prop("href",c.url).prop("host");c.dataType="iframe "+(c.dataType||"");c.formData=this._getFormData(c);if(c.redirect&&b&&b!==location.host){c.formData.push({name:c.redirectParamName||"redirect",value:c.redirect})}},_initDataSettings:function(b){if(this._isXHRUpload(b)){if(!this._chunkedUpload(b,true)){if(!b.data){this._initXHRData(b)}this._initProgressListener(b)}if(b.postMessage){b.dataType="postmessage "+(b.dataType||"")}}else{this._initIframeSettings(b)}},_getParamName:function(d){var b=a(d.fileInput),c=d.paramName;if(!c){c=[];b.each(function(){var g=a(this),e=g.prop("name")||"files[]",f=(g.prop("files")||[1]).length;while(f){c.push(e);f-=1}});if(!c.length){c=[b.prop("name")||"files[]"]}}else{if(!a.isArray(c)){c=[c]}}return c},_initFormSettings:function(b){if(!b.form||!b.form.length){b.form=a(b.fileInput.prop("form"));if(!b.form.length){b.form=a(this.options.fileInput.prop("form"))}}b.paramName=this._getParamName(b);if(!b.url){b.url=b.form.prop("action")||location.href}b.type=(b.type||b.form.prop("method")||"").toUpperCase();if(b.type!=="POST"&&b.type!=="PUT"&&b.type!=="PATCH"){b.type="POST"}if(!b.formAcceptCharset){b.formAcceptCharset=b.form.attr("accept-charset")}},_getAJAXSettings:function(c){var b=a.extend({},this.options,c);this._initFormSettings(b);this._initDataSettings(b);return b},_getDeferredState:function(b){if(b.state){return b.state()}if(b.isResolved()){return"resolved"}if(b.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(b){b.success=b.done;b.error=b.fail;b.complete=b.always;return b},_getXHRPromise:function(b,c,d){var f=a.Deferred(),e=f.promise();c=c||this.options.context||e;if(b===true){f.resolveWith(c,d)}else{if(b===false){f.rejectWith(c,d)}}e.abort=f.promise;return this._enhancePromise(e)},_addConvenienceMethods:function(b,f){var c=this,d=function(e){return a.Deferred().resolveWith(c,[e]).promise()};f.process=function(e,g){if(e||g){f._processQueue=this._processQueue=(this._processQueue||d(this)).pipe(e,g)}return this._processQueue||d(this)};f.submit=function(){if(this.state()!=="pending"){f.jqXHR=this.jqXHR=(c._trigger("submit",b,this)!==false)&&c._onSend(b,this)}return this.jqXHR||c._getXHRPromise()};f.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}return c._getXHRPromise()};f.state=function(){if(this.jqXHR){return c._getDeferredState(this.jqXHR)}if(this._processQueue){return c._getDeferredState(this._processQueue)}};f.progress=function(){return this._progress};f.response=function(){return this._response}},_getUploadedBytes:function(d){var b=d.getResponseHeader("Range"),c=b&&b.split("-"),e=c&&c.length>1&&parseInt(c[1],10);return e&&e+1},_chunkedUpload:function(h,e){h.uploadedBytes=h.uploadedBytes||0;var j=this,f=h.files[0],g=f.size,c=h.uploadedBytes,l=h.maxChunkSize||g,d=this._blobSlice,b=a.Deferred(),i=b.promise(),m,k;if(!(this._isXHRUpload(h)&&d&&(c||l<g))||h.data){return false}if(e){return true}if(c>=g){f.error=h.i18n("uploadedBytes");return this._getXHRPromise(false,h.context,[null,"error",f.error])}k=function(){var p=a.extend({},h),n=p._progress.loaded;p.blob=d.call(f,c,c+l,f.type);p.chunkSize=p.blob.size;p.contentRange="bytes "+c+"-"+(c+p.chunkSize-1)+"/"+g;j._initXHRData(p);j._initProgressListener(p);m=((j._trigger("chunksend",null,p)!==false&&a.ajax(p))||j._getXHRPromise(false,p.context)).done(function(q,o,r){c=j._getUploadedBytes(r)||(c+p.chunkSize);if(n+p.chunkSize-p._progress.loaded){j._onProgress(a.Event("progress",{lengthComputable:true,loaded:c-p.uploadedBytes,total:c-p.uploadedBytes}),p)}h.uploadedBytes=p.uploadedBytes=c;p.result=q;p.textStatus=o;p.jqXHR=r;j._trigger("chunkdone",null,p);j._trigger("chunkalways",null,p);if(c<g){k()}else{b.resolveWith(p.context,[q,o,r])}}).fail(function(r,q,o){p.jqXHR=r;p.textStatus=q;p.errorThrown=o;j._trigger("chunkfail",null,p);j._trigger("chunkalways",null,p);b.rejectWith(p.context,[r,q,o])})};this._enhancePromise(i);i.abort=function(){return m.abort()};k();return i},_beforeSend:function(b,c){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(c);this._initProgressObject(c);c._progress.loaded=c.loaded=c.uploadedBytes||0;c._progress.total=c.total=this._getTotal(c.files)||1;c._progress.bitrate=c.bitrate=0;this._active+=1;this._progress.loaded+=c.loaded;this._progress.total+=c.total},_onDone:function(f,b,g,d){var c=d._progress.total,e=d._response;if(d._progress.loaded<c){this._onProgress(a.Event("progress",{lengthComputable:true,loaded:c,total:c}),d)}e.result=d.result=f;e.textStatus=d.textStatus=b;e.jqXHR=d.jqXHR=g;this._trigger("done",null,d)},_onFail:function(e,d,c,b){var f=b._response;if(b.recalculateProgress){this._progress.loaded-=b._progress.loaded;this._progress.total-=b._progress.total}f.jqXHR=b.jqXHR=e;f.textStatus=b.textStatus=d;f.errorThrown=b.errorThrown=c;this._trigger("fail",null,b)},_onAlways:function(d,c,b,e){this._trigger("always",null,e)},_onSend:function(d,c){if(!c.submit){this._addConvenienceMethods(d,c)}var h=this,k,b,g,j,f=h._getAJAXSettings(c),i=function(){h._sending+=1;f._bitrateTimer=new h._BitrateTimer();k=k||(((b||h._trigger("send",d,f)===false)&&h._getXHRPromise(false,f.context,b))||h._chunkedUpload(f)||a.ajax(f)).done(function(l,e,m){h._onDone(l,e,m,f)}).fail(function(m,l,e){h._onFail(m,l,e,f)}).always(function(n,m,l){h._onAlways(n,m,l,f);h._sending-=1;h._active-=1;if(f.limitConcurrentUploads&&f.limitConcurrentUploads>h._sending){var e=h._slots.shift();while(e){if(h._getDeferredState(e)==="pending"){e.resolve();break}e=h._slots.shift()}}if(h._active===0){h._trigger("stop")}});return k};this._beforeSend(d,f);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){g=a.Deferred();this._slots.push(g);j=g.pipe(i)}else{this._sequence=this._sequence.pipe(i,i);j=this._sequence}j.abort=function(){b=[undefined,"abort","abort"];if(!k){if(g){g.rejectWith(f.context,b)}return i()}return k.abort()};return this._enhancePromise(j)}return i()},_onAdd:function(g,f){var k=this,n=true,h=a.extend({},this.options,f),j=h.limitMultiFileUploads,d=this._getParamName(h),b,c,l,m;if(!(h.singleFileUploads||j)||!this._isXHRUpload(h)){l=[f.files];b=[d]}else{if(!h.singleFileUploads&&j){l=[];b=[];for(m=0;m<f.files.length;m+=j){l.push(f.files.slice(m,m+j));c=d.slice(m,m+j);if(!c.length){c=d}b.push(c)}}else{b=d}}f.originalFiles=f.files;a.each(l||f.files,function(i,e){var o=a.extend({},f);o.files=l?e:[e];o.paramName=b[i];k._initResponseObject(o);k._initProgressObject(o);k._addConvenienceMethods(g,o);n=k._trigger("add",g,o);return n});return n},_replaceFileInput:function(c){var b=c.clone(true);a("<form></form>").append(b)[0].reset();c.after(b).detach();a.cleanData(c.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(d,e){if(e===c[0]){return b[0]}return e});if(c[0]===this.element[0]){this.element=b}},_handleFileTreeEntry:function(e,b){var f=this,d=a.Deferred(),c=function(h){if(h&&!h.entry){h.entry=e}d.resolve([h])},g;b=b||"";if(e.isFile){if(e._file){e._file.relativePath=b;d.resolve(e._file)}else{e.file(function(h){h.relativePath=b;d.resolve(h)},c)}}else{if(e.isDirectory){g=e.createReader();g.readEntries(function(h){f._handleFileTreeEntries(h,b+e.name+"/").done(function(i){d.resolve(i)}).fail(c)},c)}else{d.resolve([])}}return d.promise()},_handleFileTreeEntries:function(c,d){var b=this;return a.when.apply(a,a.map(c,function(e){return b._handleFileTreeEntry(e,d)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(c){c=c||{};var b=c.items;if(b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)){return this._handleFileTreeEntries(a.map(b,function(e){var d;if(e.webkitGetAsEntry){d=e.webkitGetAsEntry();if(d){d._file=e.getAsFile()}return d}return e.getAsEntry()}))}return a.Deferred().resolve(a.makeArray(c.files)).promise()},_getSingleFileInputFiles:function(b){b=a(b);var d=b.prop("webkitEntries")||b.prop("entries"),c,e;if(d&&d.length){return this._handleFileTreeEntries(d)}c=a.makeArray(b.prop("files"));if(!c.length){e=b.prop("value");if(!e){return a.Deferred().resolve([]).promise()}c=[{name:e.replace(/^.*\\/,"")}]}else{if(c[0].name===undefined&&c[0].fileName){a.each(c,function(g,f){f.name=f.fileName;f.size=f.fileSize})}}return a.Deferred().resolve(c).promise()},_getFileInputFiles:function(b){if(!(b instanceof a)||b.length===1){return this._getSingleFileInputFiles(b)}return a.when.apply(a,a.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(b){var c=this,d={fileInput:a(b.target),form:a(b.target.form)};this._getFileInputFiles(d.fileInput).always(function(e){d.files=e;if(c.options.replaceFileInput){c._replaceFileInput(d.fileInput)}if(c._trigger("change",b,d)!==false){c._onAdd(b,d)}})},_onPaste:function(b){var c=b.originalEvent&&b.originalEvent.clipboardData&&b.originalEvent.clipboardData.items,d={files:[]};if(c&&c.length){a.each(c,function(f,e){var g=e.getAsFile&&e.getAsFile();if(g){d.files.push(g)}});if(this._trigger("paste",b,d)===false||this._onAdd(b,d)===false){return false}}},_onDrop:function(b){b.dataTransfer=b.originalEvent&&b.originalEvent.dataTransfer;var c=this,d=b.dataTransfer,f={};if(d&&d.files&&d.files.length){b.preventDefault();this._getDroppedFiles(d).always(function(e){f.files=e;if(c._trigger("drop",b,f)!==false){c._onAdd(b,f)}})}},_onDragOver:function(b){b.dataTransfer=b.originalEvent&&b.originalEvent.dataTransfer;var c=b.dataTransfer;if(c){if(this._trigger("dragover",b)===false){return false}if(a.inArray("Files",c.types)!==-1){c.dropEffect="copy";b.preventDefault()}}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if(a.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(c,d){var b=a.inArray(c,this._specialOptions)!==-1;if(b){this._destroyEventHandlers()}this._super(c,d);if(b){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var b=this.options;if(b.fileInput===undefined){b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else{if(!(b.fileInput instanceof a)){b.fileInput=a(b.fileInput)}}if(!(b.dropZone instanceof a)){b.dropZone=a(b.dropZone)}if(!(b.pasteZone instanceof a)){b.pasteZone=a(b.pasteZone)}},_getRegExp:function(c){var d=c.split("/"),b=d.pop();d.shift();return new RegExp(d.join("/"),b)},_isRegExpOption:function(c,b){return c!=="url"&&a.type(b)==="string"&&/^\/.*\/[igm]{0,3}$/.test(b)},_initDataAttributes:function(){var b=this,c=this.options;a.each(a(this.element[0].cloneNode(false)).data(),function(e,d){if(b._isRegExpOption(e,d)){d=b._getRegExp(d)}c[e]=d})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(c){var b=this;if(!c||this.options.disabled){return}if(c.fileInput&&!c.files){this._getFileInputFiles(c.fileInput).always(function(d){c.files=d;b._onAdd(null,c)})}else{c.files=a.makeArray(c.files);this._onAdd(null,c)}},send:function(d){if(d&&!this.options.disabled){if(d.fileInput&&!d.files){var f=this,b=a.Deferred(),e=b.promise(),g,c;e.abort=function(){c=true;if(g){return g.abort()}b.reject(null,"abort","abort");return e};this._getFileInputFiles(d.fileInput).always(function(h){if(c){return}d.files=h;g=f._onSend(null,d).then(function(j,i,k){b.resolve(j,i,k)},function(k,j,i){b.reject(k,j,i)})});return this._enhancePromise(e)}d.files=a.makeArray(d.files);if(d.files.length){return this._onSend(null,d)}}return this._getXHRPromise(false,d&&d.context)}})}));